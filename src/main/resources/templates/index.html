<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- PAGE settings -->
  <title>网上报名系统</title>
  <meta name="description" content="Free Bootstrap 4 Pingendo Aquamarine template for unique events.">
  <meta name="keywords" content="Pingendo conference event aquamarine free template bootstrap 4">
  <!-- CSS dependencies -->
  <link rel="stylesheet" href="aquamarine.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css">
  <!-- Script: Make my navbar transparent when the document is scrolled to top -->
  <script src="js/navbar-ontop.js"></script>
  <!-- Script: Animated entrance -->
  <script src="js/animate-in.js"></script>
  <!--vue和插件-->
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios@0.12.0/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.13.1/lodash.min.js"></script>
    <script src="https://cdn.bootcss.com/qs/6.5.1/qs.min.js"></script>
</head>

<body class="text-center">
<div  id="index">
<!-- Navbar -->
<nav class="navbar navbar-expand-md fixed-top bg-dark navbar-dark">
  <div class="container">
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbar2SupportedContent" aria-controls="navbar2SupportedContent" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button>
    <div class="collapse navbar-collapse justify-content-center" id="navbar2SupportedContent" style="font-size:20px">
      <ul class="navbar-nav">
        <li class="nav-item mx-2">
          <a class="nav-link" href="#">首 页</a>
        </li>
        <li class="nav-item mx-2">
          <a class="nav-link" href="#">考试列表</a>
        </li>
        <li class="nav-item mx-2">
          <a class="nav-link" href="#">报名流程</a>
        </li>
      </ul>
    </div>
  </div>
  <a><img src="assets/conference/deheadpic.jpg" class="headpic"></a>&nbsp;
  <div id="name"><a>{{session.username}}</a></div>&nbsp;&nbsp;&nbsp;&nbsp;
  <div class="input-group w-25">
    <input type="text" class="form-control" id="inlineFormInputGroup" placeholder="Search">
    <div class="input-group-append"><button class="btn btn-primary" type="button"><i class="fa fa-search"></i></button></div>
  </div>
</nav>
<!-- Cover -->
<div class="d-flex align-items-center section-aquamarine py-5 cover" style="background-image: url(http://localhost:8080/assets/conference/cover.jpg);">
  <div class="container">
    <div class="col-lg-12 text-white mt-1">
      <h1 class="display-2 d-none d-md-block">网上报名系统</h1>
      <p style="font-size:20px">{{date}}</p>
      <div class="row" v-if="session.userid == null">
        <div class="col-md-12"><a href="/register" class="btn btn-lg btn-outline-light w-50 mt-4" style="font-size:25px">注 册</a>
        </div>
        <div class="col-md-12"><a href="/login" class="btn btn-lg btn-outline-light w-50 mt-2" style="font-size:25px">登 录</a>
        </div>
      </div>
      <div v-else>
      <div class="row" v-if="session.userrole == '学生'">
        <div class="col-md-12"><a href="/person" class="btn btn-lg btn-outline-light w-50 mt-4" style="font-size:25px">个人中心</a>
        </div>
        <div class="col-md-12"><a v-on:click="doLogout" href=""  class="btn btn-lg btn-outline-light w-50 mt-2" style="font-size:25px">退出登录</a>
        </div>
      </div>
      <div class="row" v-if="session.userrole == '管理员'">
        <div class="col-md-12"><a href="/admin" class="btn btn-lg btn-outline-light w-50 mt-4" style="font-size:25px">管理中心</a>
        </div>
        <div class="col-md-12"><a v-on:click="doLogout" href=""  class="btn btn-lg btn-outline-light w-50 mt-2" style="font-size:25px">退出登录</a>
        </div>
      </div>
      </div>
      <a href="#examlist" class="btn btn-lg mt-4 btn-outline-light w-50">查看报名列表</a>
      <i class="d-block fa fa-angle-down pt-3"></i>
    </div>
  </div>
  <div class="container">
    <div class="py-5 mt-1 text-white">
      <div class="container">
        <div class="row">
        </div>
        <div class="row">
          <div class="col-md-12">
            <h3>最新考试通知</h3>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12">
            <div id="carouselExampleIndicators" class="carousel slide carousel-fade" data-ride="carousel">
              <ol class="carousel-indicators">
                <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"> </li>
                <li data-target="#carouselExampleIndicators" data-slide-to="1" class=""> </li>
                <li data-target="#carouselExampleIndicators" data-slide-to="2" class=""> </li>
              </ol>
              <div class="carousel-inner">
                <div class="carousel-item active"> <img class="w-85" height="400px" src="assets/conference/cet4.jpg">
                  <div class="carousel-caption">
                    <h5 class="m-0">2019年大学英语四级考试</h5>
                    <p>2018-12-31 至 2019-01-14</p>
                  </div>
                </div>
                <div class="carousel-item"> <img class="d-block img-fluid w-100" height="400px" src="assets/conference/logo_2.png">
                  <div class="carousel-caption">
                    <h5 class="m-0">2019年大学英语六级考试</h5>
                    <p>2018-12-31 至 2019-01-14</p>
                  </div>
                </div>
                <div class="carousel-item"> <img class="d-block img-fluid w-100" height="400px" src="assets/conference/logo_3.png">
                  <div class="carousel-caption">
                    <h5 class="m-0">线性代数</h5>
                    <p>2018-12-31 至 2019-01-14</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Parallax section -->
<div  class="py-5 section-parallax w-100" style="background-image: url(http://localhost:8080/assets/conference/schedule.jpg)">
  <div class=" my-1 bg-light p-2" id="examlist">
    <div class="row mx-auto w-100" style="font-size:20px"  id="examlist1">
      <div class="col-md-6">
        <h1 class="mb-1" style="font-size:28px">报名列表</h1>
        <table class="table table-light table-hover" id="table1">
            <tr>
                <td>考试项目</td>
                <td>开始时间</td>
                <td>截止时间</td>
            </tr>

            <tr v-for="exam in exams">
              <td style="font-family: 楷体">{{exam.examName}}</td>
              <td>{{exam.beginTime}}</td>
              <td>{{exam.endTime}}</td>
            </tr>
        </table>
        <ul class="pagination">
          <li> <a class="page-link" href="#"> <span>«</span></a> </li>
          <li class="page-item" v-on:click="getPrePage"> <a class="page-link"> <span>上一页</span></a> </li>
          <li class="page-item" v-on:click="getNextPage"> <a class="page-link"> <span>下一页</span></a> </li>
          <li> <a class="page-link" href="#"> <span>»</span></a> </li>
        </ul>
      </div>
      <div class="col-md-6">
        <h1 class="mb-1" style="font-size:28px">即将截止</h1>
          <table class="table table-light table-hover">
              <tr>
                  <td>考试项目</td>
                  <td>开始时间</td>
                  <td>结束时间</td>
              </tr>

              <tr v-for="exam in endexams">
                <td style="font-family: 楷体">{{exam.examName}}</td> <td>{{exam.beginTime}}</td> <td>{{exam.endTime}}</td>
              </tr>
          </table>
        <ul class="pagination">
          <li class="page-item"> <a class="page-link" href="#"> <span>«</span></a> </li>
          <li class="page-item" v-on:click="getEPrePage"> <a class="page-link"> <span>上一页</span></a> </li>
          <li class="page-item" v-on:click="getENextPage"> <a class="page-link"> <span>下一页</span></a> </li>
          <li class="page-item"> <a class="page-link" href="#"> <span>»</span></a> </li>
        </ul>
      </div>
    </div>
  </div>
</div>
<!-- Speakers -->
<!-- Schedule -->
<!-- Sponsor logos -->
<!-- Call to action -->
<!-- Footer -->
<footer class="text-md-left text-center p-4 bg-dark text-light">
  <div class="container">
    <div class="row">
      <div class="my-3 col-lg-4 col-md-6">
        <h3>Conference Pingendo</h3>
        <p class="text-muted">December 12-14, 2017</p>
        <p class="my-3">
          <a href="https://goo.gl/maps/ayn28vkB5F92" target="blank" class="text-muted">Empire State building 350 5th Ave, <br>New York, NY 10118</a>
        </p>
        <a class="btn btn-lg btn-primary" href="#">Register now</a>
      </div>
      <div class="my-3 col-lg-4 col-md-6">
        <h3>Contact us</h3>
        <form>
          <fieldset class="form-group my-3">
            <input type="email" class="form-control" id="Input Email" placeholder="Email"> </fieldset>
          <fieldset class="form-group my-3">
            <input type="message" class="form-control" id="Input Message" placeholder="Message"> </fieldset>
          <button type="submit" class="btn btn-outline-primary">Submit</button>
        </form>
      </div>
      <div class="col-lg-1"> </div>
      <div class="my-3 col-lg-3">
        <h3>Follow</h3>
        <a href="https://www.facebook.com" target="blank"><i class="fa fa-facebook-square text-muted fa-3x m-2"></i></a>
        <a href="https://www.instagram.com" target="blank"><i class="fa fa-3x fa-instagram text-muted m-2"></i></a>
        <a href="https://twitter.com" target="blank"><i class="fa fa-3x fa-twitter m-2 text-muted"></i></a>
        <a href="https://plus.google.com" target="blank"><i class="fa fa-3x fa-google-plus-official text-muted m-2"></i></a>
        <a href="https://pinterest.com" target="blank"><i class="fa fa-3x text-muted fa-pinterest-p m-2"></i></a>
        <a href="https://www.youtube.com" target="blank"><i class="fa fa-3x text-muted fa-youtube-play m-2"></i></a>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <p class="text-muted">© Copyright 2018 Pingendo - All rights reserved. </p>
      </div>
    </div>
  </div>
</footer>
</div>
<!-- JavaScript dependencies -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<!--滚动-->


<script type="text/javascript">
    axios.get("http://localhost:8080/getSession").then(function (response) {
        var jsonObject = response.data;
        index.session = jsonObject;
    })

    axios.get("http://localhost:8080/exam/getexams?pageNum=1").then(function (response) {
        var jsonObject = response.data;
        index.exams = jsonObject.list;
        examsCurrentPage = jsonObject.pageNum;
        for (var i = 0; index.exams[i] != null; ++i) {
            index.exams[i].beginTime = index.exams[i].beginTime.split(".")[0].replace(/T/, " ");
            index.exams[i].endTime = index.exams[i].endTime.split(".")[0].replace(/T/, " ");
        }
    });

    axios.get("http://localhost:8080/exam/getexpiringexams?pageNum=1").then(function (response) {
        var jsonObject = response.data;
        index.endexams = jsonObject.list;
        endexamsCurrentPage = jsonObject.pageNum;
        for (var i = 0; index.endexams[i] != null; ++i) {
            index.endexams[i].beginTime = index.endexams[i].beginTime.split(".")[0].replace(/T/, " ");
            index.endexams[i].endTime = index.endexams[i].endTime.split(".")[0].replace(/T/, " ");
        }
    });

    var index = new Vue({
        el: '#index',
        data: {
            date: new Date(),
            session: [],
            exams: [],
            endexams: [],
            examsCurrentPage:1,
            endexamsCurrentPage:1
        },
        mounted () {
            var _this = this; //声明一个变量指向vue实例this,保证作用域一致
            this.timer = setInterval(function() {
               var datetime =  new Date();
              _this.date = datetime.toLocaleString() ;//2018/1/18 下午6:23:54
            }, 1000);
        },
        beforeDestroy () {
            if(this.timer) {
                clearInterval(this.timer);//在vue实例销毁钱，清除我们的定时器
            }
        },
        methods:{
            getPrePage: function (event) {
                axios.get("http://localhost:8080/exam/getexams?pageNum="+(examsCurrentPage-1)).then(function (response) {
                    var jsonObject = response.data;
                    index.exams = jsonObject.list;
                    examsCurrentPage = jsonObject.pageNum;
                    for (var i = 0; index.exams[i] != null; ++i) {
                        index.exams[i].beginTime = index.exams[i].beginTime.split(".")[0].replace(/T/, " ");
                        index.exams[i].endTime = index.exams[i].endTime.split(".")[0].replace(/T/, " ");
                    }

                })
            },
            getNextPage: function (event) {
                axios.get("http://localhost:8080/exam/getexams?pageNum="+(examsCurrentPage+1)).then(function (response) {
                    var jsonObject = response.data;
                    index.exams = jsonObject.list;
                    endexamsCurrentPage = jsonObject.pageNum;
                    for (var i = 0; index.exams[i] != null; ++i) {
                        index.exams[i].beginTime = index.exams[i].beginTime.split(".")[0].replace(/T/, " ");
                        index.exams[i].endTime = index.exams[i].endTime.split(".")[0].replace(/T/, " ");
                    }

                })

            },
            getEPrePage: function (event) {
                axios.get("http://localhost:8080/exam/getexpiringexams?pageNum="+(examsCurrentPage-1)).then(function (response) {
                    var jsonObject = response.data;
                    index.endexams = jsonObject.list;
                    endexamsCurrentPage = jsonObject.pageNum;
                    for (var i = 0; index.endexams[i] != null; ++i) {
                        index.endexams[i].beginTime = index.endexams[i].beginTime.split(".")[0].replace(/T/, " ");
                        index.endexams[i].endTime = index.endexams[i].endTime.split(".")[0].replace(/T/, " ");
                    }

                })
            },
            getENextPage: function (event) {
                axios.get("http://localhost:8080/exam/getexpiringexams?pageNum="+(examsCurrentPage+1)).then(function (response) {
                    var jsonObject = response.data;
                    index.endexams = jsonObject.list;
                    endexamsCurrentPage = jsonObject.pageNum;
                    for (var i = 0; index.endexams[i] != null; ++i) {
                        index.endexams[i].beginTime = index.endexams[i].beginTime.split(".")[0].replace(/T/, " ");
                        index.endexams[i].endTime = index.endexams[i].endTime.split(".")[0].replace(/T/, " ");
                    }

                })

            },
            doLogout:function (event) {
                axios.post('http://localhost:8080/user/logout')
                    .then(function (response) {

                    })
                    .catch(function (error) {
                        console.log(error);
                    });
            }
        }
    })

</script>
<script src="js/smooth-scroll.js"></script>
</body>
</html>